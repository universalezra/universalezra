<!DOCTYPE html>
<html lang="en" data-theme="dark">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>universalezra</title>
    <link
      rel="apple-touch-icon"
      sizes="180x180"
      href="/apple-touch-icon1.png"
    />
    <link
      rel="icon"
      type="image/png"
      sizes="32x32"
      href="/favicon-32x321.png"
    />
    <link
      rel="icon"
      type="image/png"
      sizes="16x16"
      href="/favicon-16x161.png"
    />
    <link rel="manifest" href="/site.webmanifest" />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css"
    />
    <style>
      :root {
        --primary: #8e44ad;
        --accent: #00a8ff;
        --success: #2ecc71;
        --danger: #e74c3c;
        --light: #ecf0f1;
        --dark: #1a1a2e;
        --bg-main: #16213e;
        --bg-panel: rgba(26, 26, 46, 0.9);
        --text-primary: #e0fbfc;
        --text-secondary: #98ded9;
        --border-color: rgba(0, 168, 255, 0.3);
      }
      html[data-theme='light'] {
        --primary: #3498db;
        --accent: #e67e22;
        --bg-main: #ecf0f1;
        --bg-panel: rgba(255, 255, 255, 0.9);
        --text-primary: #2c3e50;
        --text-secondary: #7f8c8d;
        --border-color: rgba(52, 152, 219, 0.4);
      }
      * {
        box-sizing: border-box;
      }
      html, body {
        width: 100%;
        height: 100%;
        margin: 0;
        padding: 0;
        overflow: hidden;
        font-family: 'Courier New', Courier, monospace;
        background-color: var(--bg-main);
        color: #00ff00;
        user-select: none;
        -webkit-user-select: none;
        -moz-user-select: none;
        -ms-user-select: none;
      }
      #main-viewport {
        position: fixed;
        top: 0;
        left: 0;
        width: 100vw;
        height: 100vh;
        overflow: hidden;
      }
      #grid-container {
        width: 500vw;
        height: 500vh;
        display: grid;
        grid-template-columns: 1fr 1fr 1fr 1fr 1fr;
        grid-template-rows: 1fr 1fr 1fr 1fr 1fr;
        transform: translate3d(-200vw, -200vh, 0);
        transition: transform 0.7s cubic-bezier(0.86, 0, 0.07, 1);
      }
      .grid-block {
        width: 100vw;
        height: 100vh;
        position: relative;
        overflow: hidden;
        display: flex;
        justify-content: center;
        align-items: center;
        flex-direction: column;
        text-align: center;
      }
      .grid-block-background {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-size: cover;
        background-position: center;
        background-repeat: no-repeat;
        filter: blur(3px);
        -webkit-filter: blur(3px);
        z-index: 1;
      }
      .grid-block-content {
        position: relative;
        z-index: 2;
        color: white;
        text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
      }
      .panel {
        position: fixed;
        background: rgba(26, 26, 46, 0.7);
        backdrop-filter: blur(15px);
        -webkit-backdrop-filter: blur(15px);
        z-index: 1010;
        box-shadow: 0 0 50px rgba(0, 0, 0, 0.6);
        transition: transform 0.5s cubic-bezier(0.68, -0.55, 0.27, 1.55);
        display: flex;
        flex-direction: column;
        color: #00ff00;
      }
      .panel.active {
        transform: translate(0, 0) !important;
      }
      #editor-panel {
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        transform: translateX(-100%);
      }
      #music-panel {
        bottom: 0;
        left: 0;
        width: 100%;
        height: auto;
        max-height: 50vh;
        border-top: 1px solid var(--border-color);
        transform: translateY(100%);
        padding: 15px;
      }
      #contribution-panel {
        top: 0;
        right: 0;
        width: 400px;
        max-width: 90vw;
        height: 100%;
        transform: translateX(100%);
        padding: 20px;
      }
      #live-visitors-panel {
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        transform: translateY(100%);
        padding: 20px;
        box-sizing: border-box;
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
      }
      #moment-vault-panel {
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        transform: translateY(100%);
        padding: 20px;
        box-sizing: border-box;
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
      }
      #visualizer-canvas {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        z-index: 99;
        display: none;
        background-color: transparent;
      }
      .visualizer-active #visualizer-canvas {
        display: block;
        pointer-events: none;
      }
      .panel-close-btn {
        position: absolute;
        top: 15px;
        right: 15px;
        background: none;
        border: none;
        color: #00ff00;
        font-size: 1.5rem;
        cursor: pointer;
        z-index: 5;
      }
      .fab-container {
        position: fixed;
        z-index: 1000;
      }
      .fab, .fab-container a {
        background: rgba(142, 68, 173, 0.7);
        color: #00ff00;
        width: 55px;
        height: 55px;
        border-radius: 50%;
        border: none;
        cursor: pointer;
        display: flex;
        justify-content: center;
        align-items: center;
        font-size: 1.4rem;
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        transition: all 0.3s ease;
        text-decoration: none;
      }
      .fab:hover, .fab-container a:hover {
        background: var(--accent);
        transform: scale(1.1);
      }
      #fab-editor {
        top: 20px;
        left: 20px;
      }
      #fab-music {
        top: 50%;
        left: 20px;
        transform: translateY(-50%);
      }
      #fab-alkitab {
        top: 20px;
        right: 20px;
      }
      #fab-contribution {
        top: calc(50% + 70px);
        left: 20px;
        transform: translateY(-50%);
      }
      #fab-visualizer {
        bottom: 20px;
        left: 50%;
        transform: translateX(-120%);
      }
      #fab-moment-vault {
        bottom: 20px;
        left: 50%;
        transform: translateX(0%); /* Posisi baru, bergeser ke kiri */
      }
      #fab-live-visitors {
        bottom: 90px;
        left: 50%;
        transform: translateX(-50%);
        display: none; /* Sembunyikan secara default */
      }
      #fab-dashboard {
        bottom: 20px;
        left: 20px;
        display: flex;
      }
      #fab-keyboard-toggle {
        bottom: 20px;
        right: 20px;
      }
      #keyboard-panel {
        bottom: 100px;
        left: 50%;
        width: 400px;
        max-width: 95vw;
        height: auto;
        transform: translate(-50%, 100%);
        padding: 10px;
        border-radius: 10px;
        box-shadow: 0 0 20px rgba(0,0,0,0.5);
        display: flex;
        flex-direction: column;
        color: var(--text-primary);
        z-index: 1010;
        position: fixed;
      }
      #keyboard-panel.active {
          transform: translate(-50%, 0) !important;
      }
      #keyboard-input {
          width: 100%;
          padding: 8px;
          font-size: 1em;
          background: rgba(0,0,0,0.2);
          border: 1px solid var(--border-color);
          color: var(--text-primary);
          margin-bottom: 8px;
          border-radius: 5px;
          text-align: center;
      }
      .keyboard-row {
          display: flex;
          justify-content: center;
          gap: 4px;
          margin-bottom: 4px;
      }
      .keyboard-key {
          flex: 1;
          background: var(--primary);
          border: none;
          padding: 10px;
          color: var(--text-primary);
          font-size: 1em;
          border-radius: 5px;
          cursor: pointer;
          transition: background-color 0.2s;
          text-transform: lowercase;
      }
      .keyboard-key:hover {
          background: var(--accent);
      }
      .keyboard-key.special {
          background: var(--dark);
      }
      .keyboard-key.space {
          flex: 2;
      }
      #live-visitors-panel .live-visitors-content,
      #moment-vault-panel .moment-vault-content,
      #dashboard-panel .dashboard-content {
          width: 100%;
          height: 100%;
          max-width: 1200px;
          background: var(--bg-panel);
          border-radius: 15px;
          box-shadow: 0 0 30px rgba(0, 0, 0, 0.5);
          overflow: hidden;
      }
      #visitor-list ul {
          list-style: none;
          padding: 0;
          margin: 0;
          display: grid;
          grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
          gap: 15px;
      }
      #visitor-history ul {
          list-style: none;
          padding: 0;
          margin: 0;
          max-height: 200px;
          overflow-y: auto;
      }
      #visitor-history li {
          background: rgba(142, 68, 173, 0.1);
          border: 1px solid rgba(142, 68, 173, 0.2);
          border-radius: 10px;
          padding: 10px;
          font-size: 0.8em;
          color: var(--text-primary);
          margin-bottom: 8px;
          display: flex;
          justify-content: space-between;
      }
      #moment-vault-gallery-container {
        flex-grow: 1; 
        overflow-y: auto; 
        padding-right: 10px;
      }
      #moment-vault-gallery {
          display: grid;
          grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
          gap: 15px;
      }
      #moment-upload-form input, #moment-upload-form textarea, #moment-upload-form button {
        margin-top: 10px;
      }
      .gallery-item {
        background: rgba(0, 0, 0, 0.2);
        border: 1px solid var(--border-color);
        border-radius: 10px;
        padding: 10px;
        display: flex;
        flex-direction: column;
        align-items: center;
        text-align: center;
        gap: 8px;
        position: relative;
      }
      .gallery-media {
        width: 100%;
        height: 120px;
        display: flex;
        justify-content: center;
        align-items: center;
        overflow: hidden;
        border-radius: 5px;
        background-color: #333;
      }
      .gallery-media img, .gallery-media video, .gallery-media audio {
        width: 100%;
        height: 100%;
        object-fit: cover;
      }
      .gallery-media .file-icon {
        font-size: 3em;
        color: var(--text-secondary);
      }
      #video-player-widget {
        position: fixed;
        top: 20px;
        left: 50%;
        transform: translateX(-50%);
        z-index: 999;
        width: 150px;
        height: 150px;
        border-radius: 10px;
        overflow: hidden;
        box-shadow: 0 5px 20px rgba(0, 0, 0, 0.4);
        border: 2px solid var(--border-color);
      }
      #video-player-widget video {
        width: 100%;
        height: 100%;
        object-fit: cover;
      }
      .social-links {
        position: fixed;
        top: 50%;
        right: 20px;
        transform: translateY(-50%);
        display: flex;
        flex-direction: column;
        gap: 15px;
        z-index: 999;
      }
      #website-age-display {
        position: fixed;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        font-size: 0.8em;
        color: #00ff00;
        z-index: 10;
        background: none;
        padding: 0;
        text-align: center;
        white-space: nowrap;
      }
      .editor-toolbar {
        padding: 10px;
        display: flex;
        gap: 10px;
        flex-wrap: wrap;
      }
      .editor-toolbar button {
        background: var(--accent);
        color: var(--text-primary);
        border: none;
        padding: 8px 12px;
        border-radius: 5px;
        cursor: pointer;
        transition: background-color 0.2s;
      }
      .editor-toolbar button:hover {
        background: var(--primary);
      }
      .editor-main {
        display: flex;
        flex-grow: 1;
        gap: 10px;
        padding: 10px;
      }
      .editor-code-area, .editor-preview-area {
        flex: 1;
        border: 1px solid var(--border-color);
        border-radius: 5px;
        overflow: hidden;
      }
      #unified-code-editor {
        width: 100%;
        height: 100%;
        background: rgba(0,0,0,0.3);
        color: var(--text-primary);
        border: none;
        padding: 10px;
        resize: none;
        outline: none;
      }
      #editor-preview {
        width: 100%;
        height: 100%;
        border: none;
        background: var(--light);
      }
      #video-player-widget .video-controls {
          position: absolute;
          bottom: 0;
          left: 0;
          width: 100%;
          display: flex;
          justify-content: space-evenly;
          align-items: center;
          padding: 5px 0;
          background: rgba(0, 0, 0, 0.5);
          backdrop-filter: blur(5px);
          -webkit-backdrop-filter: blur(5px);
          transition: opacity 0.3s ease;
          opacity: 0;
      }
      #video-player-widget:hover .video-controls {
          opacity: 1;
      }
      #video-player-widget .video-controls button {
          background: none;
          border: none;
          color: white;
          font-size: 1rem;
          cursor: pointer;
          padding: 5px;
      }
      #moment-vault-panel h3 {
        padding: 10px 20px;
        border-radius: 10px;
        background: rgba(0, 0, 0, 0.4);
        backdrop-filter: blur(10px);
        -webkit-backdrop-filter: blur(10px);
      }
      #moment-upload-form {
        width: 100%;
        max-width: 600px;
      }
      #moment-upload-form input, #moment-upload-form textarea {
        display: block;
        width: 100%;
        margin-top: 15px;
        padding: 12px;
        background: rgba(0, 0, 0, 0.4);
        border: 1px solid var(--border-color);
        color: var(--text-primary);
        border-radius: 8px;
      }
      #moment-upload-form button {
        width: 100%;
        padding: 12px;
        background: var(--accent);
        border: none;
        color: white;
        font-size: 1em;
        cursor: pointer;
        border-radius: 8px;
        transition: background 0.3s ease;
      }
      #moment-upload-form button:hover {
        background: var(--primary);
      }
      .grid-block-background video {
        width: 100%;
        height: 100%;
        object-fit: cover;
        position: absolute;
        top: 0;
        left: 0;
        z-index: -1;
      }
      #block-4-3 .grid-block-background {
        -webkit-filter: none;
        -moz-filter: none;
        -ms-filter: none;
        filter: none;
      }
      #block-3-4 .grid-block-background {
        -webkit-filter: none;
        filter: none;
        background-size: cover;
        background-position: center;
        background-repeat: no-repeat;
      }
      #block-3-2 .grid-block-content {
          width: 100%;
          height: 100%;
          padding: 10px;
          display: flex;
          flex-direction: column;
      }
      #block-3-2 .grid-block-content iframe {
          flex-grow: 1;
          width: 100%;
          height: 100%;
          border: none;
      }
      #center-video-container {
          position: fixed;
          top: 50%;
          left: 50%;
          transform: translate(-50%, -50%);
          z-index: 1100;
          width: 80vw;
          height: 80vh;
          max-width: 1200px;
          max-height: 800px;
          background: rgba(0,0,0,0.9);
          border: 2px solid var(--accent);
          border-radius: 10px;
          display: flex;
          justify-content: center;
          align-items: center;
          flex-direction: column;
          box-shadow: 0 0 50px rgba(0,0,0,0.8);
          display: none;
      }
      #center-video-container.active {
          display: flex;
      }
      #center-video-container video {
          width: 95%;
          height: 95%;
          object-fit: contain;
      }
      #center-video-close {
          position: absolute;
          top: 10px;
          right: 10px;
          font-size: 2rem;
          color: white;
          cursor: pointer;
          background: none;
          border: none;
          z-index: 10;
      }
      #dashboard-panel {
          bottom: 0;
          left: 0;
          width: 400px;
          max-width: 90vw;
          height: 100%;
          transform: translateX(-100%);
          padding: 20px;
      }
      .dashboard-item {
          background: rgba(0,0,0,0.2);
          padding: 15px;
          margin-bottom: 15px;
          border-radius: 10px;
          border: 1px solid var(--border-color);
      }
      .dashboard-content {
        overflow-y: auto;
        padding-right: 10px;
      }
      #watermark {
        position: fixed;
        bottom: 10px;
        right: 10px;
        color: rgba(255, 255, 255, 0.1);
        font-size: 2em;
        font-weight: bold;
        pointer-events: none;
        z-index: 1000;
        text-shadow: 0 0 5px rgba(0,0,0,0.5);
      }
      #screenshot-popup {
          position: fixed;
          top: 50%;
          left: 50%;
          transform: translate(-50%, -50%);
          background: rgba(26, 26, 46, 0.95);
          color: white;
          padding: 20px;
          border-radius: 10px;
          box-shadow: 0 0 30px rgba(0,0,0,0.8);
          z-index: 2000;
          display: none;
          text-align: center;
          animation: fadeIn 0.3s ease-out;
      }
      @keyframes fadeIn {
          from { opacity: 0; transform: translate(-50%, -60%); }
          to { opacity: 1; transform: translate(-50%, -50%); }
      }
      .no-select {
        user-select: none;
        -webkit-user-select: none;
        -moz-user-select: none;
        -ms-user-select: none;
      }
    </style>
  </head>
  <body>
    <canvas id="visualizer-canvas"></canvas>  
    <div id="main-viewport" class="no-select">
      <div id="grid-container">   
        <div class="grid-block" id="block-1-1">
          <div class="grid-block-background" style="background-image: url('https://picsum.photos/1920/1080?random=1');"></div>
          <div class="grid-block-content"><h1>Block (1,1)</h1></div>
        </div>
        <div class="grid-block" id="block-1-2">
          <div class="grid-block-background" style="background-image: url('https://picsum.photos/1920/1080?random=2');"></div>
          <div class="grid-block-content"><h1>Block (1,2)</h1></div>
        </div>
        <div class="grid-block" id="block-1-3">
          <div class="grid-block-background" style="background-image: url('https://picsum.photos/1920/1080?random=3');"></div>
          <div class="grid-block-content"><h1>Block (1,3)</h1></div>
        </div>
        <div class="grid-block" id="block-1-4">
          <div class="grid-block-background" style="background-image: url('https://picsum.photos/1920/1080?random=4');"></div>
          <div class="grid-block-content"><h1>Block (1,4)</h1></div>
        </div>
        <div class="grid-block" id="block-1-5">
          <div class="grid-block-background" style="background-image: url('https://picsum.photos/1920/1080?random=5');"></div>
          <div class="grid-block-content"><h1>Block (1,5)</h1></div>
        </div>
        <div class="grid-block" id="block-2-1">
          <div class="grid-block-background" style="background-image: url('https://picsum.photos/1920/1080?random=6');"></div>
          <div class="grid-block-content"><h1>Block (2,1)</h1></div>
        </div>
        <div class="grid-block" id="block-2-2">
          <div class="grid-block-background" style="background-image: url('https://picsum.photos/1920/1080?random=7');"></div>
          <div class="grid-block-content"><h1>Block (2,2)</h1></div>
        </div>
        <div class="grid-block" id="block-2-3">
          <div class="grid-block-background" style="background-image: url('https://picsum.photos/1920/1080?random=8');"></div>
          <div class="grid-block-content"><h1>Block (2,3)</h1></div>
        </div>
        <div class="grid-block" id="block-2-4">
          <div class="grid-block-background" style="background-image: url('https://picsum.photos/1920/1080?random=9');"></div>
          <div class="grid-block-content"><h1>Block (2,4)</h1></div>
        </div>
        <div class="grid-block" id="block-2-5">
          <div class="grid-block-background" style="background-image: url('https://picsum.photos/1920/1080?random=10');"></div>
          <div class="grid-block-content"><h1>Block (2,5)</h1></div>
        </div>    
        <div class="grid-block" id="block-3-1">
          <div class="grid-block-background" style="background-image: url('https://picsum.photos/1920/1080?random=11');"></div>
          <div class="grid-block-content"><h1>Block (3,1)</h1></div>
        </div>
        <div class="grid-block" id="block-3-2">
          <div class="grid-block-content">
              <h3>Ayat Hari Ini</h3>
              <iframe src="https://alkitab.sabda.org/daily/widget.php" width="100%" height="100%" frameborder="0"></iframe>
          </div>
        </div>
        <div class="grid-block" id="block-center">
          <div class="grid-block-background" id="interactive-bg" style="background-image: url('wallpaper.png');"></div>
          <div class="grid-block-content">
              <div class="central-message">
                  <p>By <a href="secret.html" class="ezra-link">Ezra</a></p>
              </div>
              <div class="panel" id="contribution-panel-desktop" style="display: none"></div>
          </div>
        </div>
        <div class="grid-block" id="block-3-4">
          <div class="grid-block-background" style="background-image: url('https://universalezra.netlify.app/moments/1751293320517-December 13, 2024 at 4.29 AM (1).jpg');"></div>
        </div>
        <div class="grid-block" id="block-3-5">
          <div class="grid-block-background" style="background-image: url('https://picsum.photos/1920/1080?random=15');"></div>
          <div class="grid-block-content"><h1>Block (3,5)</h1></div>
        </div>
        <div class="grid-block" id="block-4-1">
          <div class="grid-block-background" style="background-image: url('https://picsum.photos/1920/1080?random=16');"></div>
          <div class="grid-block-content"><h1>Block (4,1)</h1></div>
        </div>
        <div class="grid-block" id="block-4-2">
          <div class="grid-block-background" style="background-image: url('https://picsum.photos/1920/1080?random=17');"></div>
          <div class="grid-block-content"><h1>Block (4,2)</h1></div>
        </div>
        <div class="grid-block" id="block-4-3">
    <div class="grid-block-background">
        <video autoplay loop muted playsinline>
            <source src="bg.mp4" type="video/mp4">
            </video>
    </div>
    <div class="grid-block-content">
      </div>
        </div>
        <div class="grid-block" id="block-4-4">
          <div class="grid-block-background" style="background-image: url('https://picsum.photos/1920/1080?random=19');"></div>
          <div class="grid-block-content"><h1>Block (4,4)</h1></div>
        </div>
        <div class="grid-block" id="block-4-5">
          <div class="grid-block-background" style="background-image: url('https://picsum.photos/1920/1080?random=20');"></div>
          <div class="grid-block-content"><h1>Block (4,5)</h1></div>
        </div>
        <div class="grid-block" id="block-5-1">
          <div class="grid-block-background" style="background-image: url('https://picsum.photos/1920/1080?random=21');"></div>
          <div class="grid-block-content"><h1>Block (5,1)</h1></div>
        </div>
        <div class="grid-block" id="block-5-2">
          <div class="grid-block-background" style="background-image: url('https://picsum.photos/1920/1080?random=22');"></div>
          <div class="grid-block-content"><h1>Block (5,2)</h1></div>
        </div>
        <div class="grid-block" id="block-5-3">
          <div class="grid-block-background" style="background-image: url('https://picsum.photos/1920/1080?random=23');"></div>
          <div class="grid-block-content"><h1>Block (5,3)</h1></div>
        </div>
        <div class="grid-block" id="block-5-4">
          <div class="grid-block-background" style="background-image: url('https://picsum.photos/1920/1080?random=24');"></div>
          <div class="grid-block-content"><h1>Block (5,4)</h1></div>
        </div>
        <div class="grid-block" id="block-5-5">
          <div class="grid-block-background" style="background-image: url('https://picsum.photos/1920/1080?random=25');"></div>
          <div class="grid-block-content"><h1>Block (5,5)</h1></div>
        </div>      
      </div>
    </div>  
    <div class="fab-container" id="fab-editor">
        <button class="fab" data-panel="editor-panel" title="Code Editor">
            <i class="fas fa-code"></i>
        </button>
    </div>
    <div class="fab-container" id="fab-music">
        <button class="fab" data-panel="music-panel" title="Music Player">
            <i class="fas fa-music"></i>
        </button>
    </div>
    <div class="fab-container" id="fab-contribution">
        <button class="fab" data-panel="contribution-panel" title="Leave a Message">
            <i class="fas fa-feather-alt"></i>
        </button>
    </div>
    <div class="fab-container" id="fab-alkitab">
        <a
            class="fab"
            href="https://alkitab.me/in-tb/Matius/5/13"
            target="_blank"
            title="Alkitab"
            ><i class="fas fa-book"></i
        ></a>
    </div>
    <div class="fab-container" id="fab-visualizer">
        <button class="fab" data-panel="visualizer" title="Visualizer">
            <i class="fas fa-expand"></i>
        </button>
    </div>
    <div class="fab-container" id="fab-moment-vault">
        <button class="fab" data-panel="moment-vault-panel" title="Moment Vault">
            <i class="fas fa-archive"></i>
        </button>
    </div>
    <div class="fab-container" id="fab-live-visitors">
        <button class="fab" data-panel="live-visitors-panel" title="Live Visitors">
            <i class="fas fa-eye"></i>
        </button>
    </div>
    <div class="fab-container" id="fab-dashboard">
        <button class="fab" data-panel="dashboard-panel" title="Dashboard">
            <i class="fas fa-chart-line"></i>
        </button>
    </div>
    <div class="fab-container" id="fab-keyboard-toggle">
        <button class="fab" data-panel="keyboard-panel" title="Virtual Keyboard">
            <i class="fas fa-keyboard"></i>
        </button>
    </div>
    <div id="video-player-widget">
        <video id="widget-video" loop src="video.mp4"></video>
        <div class="video-controls">
            <button id="video-play-pause"><i class="fas fa-play"></i></button>
            <button id="video-mute"><i class="fas fa-volume-up"></i></button>
        </div>
    </div>
    <div class="social-links">
        <a href="https://wa.me/6283844959380" target="_blank" title="WhatsApp"><i class="fab fa-whatsapp"></i></a>
        <a href="https://instagram.com/zilifucek" target="_blank" title="Instagram"><i class="fab fa-instagram"></i></a>
    </div>
    <div id="website-age-display"></div>
    <div class="panel" id="editor-panel">
        <button class="panel-close-btn" data-panel="editor-panel"><i class="fas fa-times"></i></button>
        <div class="editor-toolbar">
            <button id="editor-run"><i class="fas fa-play"></i> Run</button>
            <button id="editor-save"><i class="fas fa-save"></i> Save</button>
            <button id="editor-load"><i class="fas fa-folder-open"></i> Load</button>
            <button id="editor-new"><i class="fas fa-file"></i> New</button>
            <button id="editor-undo"><i class="fas fa-undo"></i> Undo</button>
            <button id="editor-redo"><span><i class="fas fa-redo"></i> Redo</span></button>
        </div>
        <div class="editor-main">
            <div class="editor-code-area">
                <textarea id="unified-code-editor" spellcheck="false"></textarea>
            </div>
            <div class="editor-preview-area">
                <iframe id="editor-preview"></iframe>
            </div>
        </div>
    </div>
    <div class="panel" id="music-panel">
        <button class="panel-close-btn" data-panel="music-panel"><i class="fas fa-times"></i></button>
        <h4>Now Playing</h4>
        <div id="music-player-content">
            <h5 id="song-title">Select a song</h5>
            <audio id="audio-player" controls loop style="width: 100%"></audio>
            <div id="playlist" style="max-height: 20vh; overflow-y: auto; margin-top: 10px"></div>
        </div>
    </div>
    <div class="panel" id="contribution-panel">
        <button class="panel-close-btn" data-panel="contribution-panel"><i class="fas fa-times"></i></button>
        <div id="contribution-content" style="display: flex; flex-direction: column; height: 100%">
            <h3 style="margin-top: 20px">Leave a Message</h3>
            <div id="contribution-display" style="flex-grow: 1; overflow-y: auto; padding-right: 10px; margin-bottom: 15px">
                <p>Loading</p>
            </div>
            <form id="contribution-form">
                <textarea id="contribution-text" placeholder="Your message" required style="width: 100%; min-height: 80px; background: rgba(0, 0, 0, 0.2); color: var(--text-primary); border: 1px solid var(--border-color); border-radius: 5px; padding: 10px;"></textarea>
                <div style="display: flex; justify-content: flex-end; align-items: center; margin-top: 10px;">
                    <button type="submit" class="fab" style="position: static; width: 45px; height: 45px; font-size: 1.1rem">
                        <i class="fas fa-paper-plane"></i>
                    </button>
                </div>
                <p id="contribution-status" style="font-size: 0.9em; text-align: center; margin-top: 10px"></p>
            </form>
        </div>
    </div>
    <div class="panel" id="live-visitors-panel">
        <button class="panel-close-btn" data-panel="live-visitors-panel"><i class="fas fa-times"></i></button>
        <div class="live-visitors-content">
            <h3 style="margin-bottom: 15px; color: var(--accent); text-align: center">Live Visitors</h3>
            <div id="mv-live-visitors-list-container" style="flex-grow: 1; overflow-y: auto; padding-right: 10px">
                <p style="text-align: center; color: var(--text-secondary)">visitor</p>
                <ul id="visitor-list" style="list-style: none; padding: 0; margin: 0"></ul>
            </div>
            <h4 style="margin-top: 20px; color: var(--primary); text-align: center;">Visitor History</h4>
            <div id="visitor-history" style="flex-grow: 1; overflow-y: auto; padding-right: 10px; margin-top: 10px;">
                <p style="text-align: center; color: var(--text-secondary);">Loading history</p>
            </div>
            <div style="margin-top: 15px; text-align: center; font-size: 0.85em; color: var(--text-secondary)">
                updated: <span id="last-updated-time">N/A</span>
            </div>
        </div>
    </div>
    <div class="panel" id="moment-vault-panel">
        <button class="panel-close-btn" data-panel="moment-vault-panel"><i class="fas fa-times"></i></button>
        <div class="moment-vault-content" style="display: flex; flex-direction: column; height: 100%;">
            <h3 style="margin-bottom: 15px; color: var(--accent); text-align: center">Share your moment here</h3>
            <div id="moment-vault-gallery-container" style="flex-grow: 1; overflow-y: auto; padding-right: 10px; margin-bottom: 15px;">
                <p style="text-align: center; color: var(--text-secondary)">Memories</p>
                <div id="moment-vault-gallery"></div>
            </div>
            <form id="moment-upload-form">
                <input type="text" id="moment-title" placeholder="Title" required />
                <textarea id="moment-description" placeholder="Describe" rows="3"></textarea>
                <input type="file" id="moment-file" accept="image/*,video/*,audio/*,.pdf,.doc,.docx,.txt" required/>
                <button type="submit">Upload</button>
                <p id="moment-upload-status" style="font-size: 0.9em; text-align: center; margin-top: 10px"></p>
            </form>
        </div>
    </div>
    <div class="panel" id="dashboard-panel">
        <button class="panel-close-btn" data-panel="dashboard-panel"><i class="fas fa-times"></i></button>
        <div class="dashboard-content">
            <h3 style="margin-bottom: 15px; color: var(--accent); text-align: center">Target Dashboard</h3>
            <div id="dashboard-items">
                <div class="dashboard-item">
                    <h4>Proyek Web Dev</h4>
                    <p>Target: Pelajari framework ReactJS dan Tailwind CSS.</p>
                    <small>Status: Belum Dimulai</small>
                </div>
                <div class="dashboard-item">
                    <h4>Peningkatan Skill</h4>
                    <p>Target: Kuasai 5 algoritma sorting dasar.</p>
                    <small>Status: Sedang Dikerjakan</small>
                </div>
                <div class="dashboard-item">
                    <h4>Kesehatan</h4>
                    <p>Target: Lari 5km setiap minggu.</p>
                    <small>Status: Selesai</small>
                </div>
                <div class="dashboard-item">
                    <h4>Proyek AI</h4>
                    <p>Target: Bangun model machine learning sederhana dengan Python.</p>
                    <small>Status: Tahap Riset</small>
                </div>
            </div>
        </div>
    </div>
    <div class="panel" id="keyboard-panel">
        <button class="panel-close-btn" data-panel="keyboard-panel"><i class="fas fa-times"></i></button>
        <input type="text" id="keyboard-input" placeholder="Enter password..." readonly />
        <div class="keyboard-row">
            <button class="keyboard-key">q</button>
            <button class="keyboard-key">w</button>
            <button class="keyboard-key">e</button>
            <button class="keyboard-key">r</button>
            <button class="keyboard-key">t</button>
            <button class="keyboard-key">y</button>
            <button class="keyboard-key">u</button>
            <button class="keyboard-key">i</button>
            <button class="keyboard-key">o</button>
            <button class="keyboard-key">p</button>
        </div>
        <div class="keyboard-row">
            <button class="keyboard-key">a</button>
            <button class="keyboard-key">s</button>
            <button class="keyboard-key">d</button>
            <button class="keyboard-key">f</button>
            <button class="keyboard-key">g</button>
            <button class="keyboard-key">h</button>
            <button class="keyboard-key">j</button>
            <button class="keyboard-key">k</button>
            <button class="keyboard-key">l</button>
        </div>
        <div class="keyboard-row">
            <button class="keyboard-key">z</button>
            <button class="keyboard-key">x</button>
            <button class="keyboard-key">c</button>
            <button class="keyboard-key">v</button>
            <button class="keyboard-key">b</button>
            <button class="keyboard-key">n</button>
            <button class="keyboard-key">m</button>
            <button class="keyboard-key">4</button>
            <button class="keyboard-key">7</button>
            <button class="keyboard-key special" id="backspace-key"><i class="fas fa-backspace"></i></button>
        </div>
        <div class="keyboard-row">
            <button class="keyboard-key space" id="space-key">space</button>
        </div>
    </div>
    <div id="center-video-container">
        <button id="center-video-close"><i class="fas fa-times"></i></button>
        <video id="center-video-player" loop muted playsinline></video>
    </div>
    <div id="watermark">Ezra A</div>
    <div id="screenshot-popup">
        <h4>Warning</h4>
        <p>Tolong jangan ambil screenshot. Konten ini dilindungi.</p>
    </div>
    <script>
      const CONTRIBUTIONS_WORKER_URL =
        'https://contributions-workerjs.ezvvel.workers.dev/';
      const MOMENT_VAULT_WORKER_URL =
        'https://moment-vault-worker-url.universalezra.workers.dev';
      const GITHUB_REPO_OWNER = 'universalezra';
      const GITHUB_REPO_NAME = 'universalezra';
      const GITHUB_TOKEN_WORKER_URL =
        'https://github-token-worker-url.universalezra.workers.dev';
      let liveVisitorRefreshInterval;
      let isEzraLoggedIn = false;
      const LIVE_VISITORS_WORKER_URL =
        'https://live-visitors.ezvvel.workers.dev/';
      // GANTI URL INI DENGAN URL GOOGLE APPS SCRIPT ANDA
      const VISITOR_HISTORY_WORKER_URL =
        'https://your-new-history-worker.yourdomain.workers.dev/'; 
      const VISITOR_HISTORY_EXPIRY_DAYS = 7;
      const REFRESH_INTERVAL_MS = 5000;
      const LIVE_VISITORS_PASSWORD = '💔';
      const MOMENT_VAULT_PASSWORD = 'vmoments';
      const CENTER_VIDEO_PASSWORD = 'elviu';
      let isVisualizerActive = false;
      let visualizerCanvas, ctx, audioContext, analyser, source;
      let particles = [];
      let bufferLength, dataArray, frequencyData;
      const PARTICLE_COUNT = 200;
      const PARTICLE_SPEED_MULTIPLIER = 0.5;
      let gravity = { x: 0, y: 0 };   
      let gridContainer, currentX = 2, currentY = 2;
      let isDragging = false;
      let startX = 0, startY = 0;
      const SWIPE_THRESHOLD = 50;
      document.addEventListener('DOMContentLoaded', () => {
        gridContainer = document.getElementById('grid-container');
        initPanelControls();
        initVideoPlayer();
        initEditor();
        initMusicPlayer();
        initWebsiteAgeDisplay();
        trackVisitor();
        initVisualizer();
        initSwipeGestures();
        initVirtualKeyboard();
        initSecurityFeatures();
      });
      function initSwipeGestures() {
        const moveGrid = (x, y) => {
            currentX = Math.min(4, Math.max(0, currentX + x));
            currentY = Math.min(4, Math.max(0, currentY + y));
            gridContainer.style.transform = `translate3d(-${currentX * 100}vw, -${currentY * 100}vh, 0)`;
        };
        const handleStart = (e) => {
            isDragging = true;
            startX = e.clientX || e.touches[0].clientX;
            startY = e.clientY || e.touches[0].clientY;
        };
        const handleEnd = (e) => {
            if (!isDragging) return;
            const endX = e.clientX || e.changedTouches[0].clientX;
            const endY = e.clientY || e.changedTouches[0].clientY;
            const dx = endX - startX;
            const dy = endY - startY;
            isDragging = false;
            if (Math.abs(dx) > Math.abs(dy) && Math.abs(dx) > SWIPE_THRESHOLD) {
                if (dx > 0) {
                    moveGrid(-1, 0);
                } else {
                    moveGrid(1, 0);
                }
            } else if (Math.abs(dy) > Math.abs(dx) && Math.abs(dy) > SWIPE_THRESHOLD) {
                if (dy > 0) {
                    moveGrid(0, -1);
                } else {
                    moveGrid(0, 1);
                }
            }
        };
        document.addEventListener('mousedown', handleStart);
        document.addEventListener('mouseup', handleEnd);
        document.addEventListener('touchstart', handleStart);
        document.addEventListener('touchend', handleEnd);
      }
      function initPanelControls() {
        document.querySelectorAll('[data-panel]').forEach((button) => {
          button.addEventListener('click', (event) => {
            const panelId = button.getAttribute('data-panel');
            const panel = document.getElementById(panelId);
            if (panelId === 'live-visitors-panel') {
              const password = prompt('Please enter the password to unlock this feature:');
              if (password === LIVE_VISITORS_PASSWORD) {
                isEzraLoggedIn = true;
                panel.classList.toggle('active');
                if (panel.classList.contains('active')) {
                  fetchLiveVisitors();
                  fetchVisitorHistory();
                  liveVisitorRefreshInterval = setInterval(fetchLiveVisitors, REFRESH_INTERVAL_MS);
                } else {
                  clearInterval(liveVisitorRefreshInterval);
                  document.getElementById('visitor-list').innerHTML = '';
                  document.getElementById('visitor-history').innerHTML = '';
                }
              } else {
                alert('Incorrect or blank password!');
                isEzraLoggedIn = false;
                return;
              }
            } else if (panelId === 'visualizer') {
              toggleVisualizerOverlay();
            } else {
              panel.classList.toggle('active');
              if (panelId === 'contribution-panel' && panel.classList.contains('active')) {
                fetchContributions();
              } else if (panelId === 'moment-vault-panel') {
                if (panel.classList.contains('active')) {
                  fetchMomentVaultGallery();
                } else {
                  document.getElementById('moment-vault-gallery').innerHTML = '';
                }
              }
              document.querySelectorAll('.panel').forEach((otherPanel) => {
                if (otherPanel.id !== panelId) {
                  otherPanel.classList.remove('active');
                  if (otherPanel.id === 'live-visitors-panel') {
                    clearInterval(liveVisitorRefreshInterval);
                    document.getElementById('visitor-list').innerHTML = '';
                    document.getElementById('visitor-history').innerHTML = '';
                    isEzraLoggedIn = false;
                  }
                  if (otherPanel.id === 'moment-vault-panel') {
                    document.getElementById('moment-vault-gallery').innerHTML = '';
                  }
                }
              });
            }
          });
        });
        document.querySelectorAll('.panel-close-btn').forEach((button) => {
          button.addEventListener('click', () => {
            const panelId = button.getAttribute('data-panel');
            const panel = document.getElementById(panelId);
            panel.classList.remove('active');
            if (panelId === 'live-visitors-panel') {
              clearInterval(liveVisitorRefreshInterval);
              document.getElementById('visitor-list').innerHTML = '';
              document.getElementById('visitor-history').innerHTML = '';
              isEzraLoggedIn = false;
            }
            if (panelId === 'moment-vault-panel') {
              document.getElementById('moment-vault-gallery').innerHTML = '';
            }
          });
        });
      }
      function initVideoPlayer() {
        const video = document.getElementById('widget-video');
        const playBtn = document.getElementById('video-play-pause');
        const muteBtn = document.getElementById('video-mute');
        playBtn.addEventListener('click', () => {
          if (video.paused) {
            video.play();
            playBtn.innerHTML = '<i class="fas fa-pause"></i>';
          } else {
            video.pause();
            playBtn.innerHTML = '<i class="fas fa-play"></i>';
          }
        });
        muteBtn.addEventListener('click', () => {
          video.muted = !video.muted;
          muteBtn.innerHTML = video.muted
            ? '<i class="fas fa-volume-mute"></i>'
            : '<i class="fas fa-volume-up"></i>';
        });
      }
      function initMusicPlayer() {
        const player = document.getElementById('audio-player');
        const playlistEl = document.getElementById('playlist');
        const songTitleEl = document.getElementById('song-title');
        const songs = [
          { name: 'On And On', url: 'On-And-On.mp3' },
          { name: 'Where We Are', url: 'Where-We-Are.mp3' },
          { name: 'Sekuat Hatimu', url: 'Sekuat Hatimu.mp3' },
        ];
        songs.forEach((song, index) => {
          const item = document.createElement('div');
          item.textContent = song.name;
          item.style.cursor = 'pointer';
          item.style.padding = '8px';
          item.onclick = () => {
            player.src = song.url;
            songTitleEl.textContent = song.name;
            player.play();
          };
          playlistEl.appendChild(item);
        });
      }
      function initEditor() {
        const codeEditor = document.getElementById('unified-code-editor');
        const previewFrame = document.getElementById('editor-preview');
        const runBtn = document.getElementById('editor-run');
        const saveBtn = document.getElementById('editor-save');
        const loadBtn = document.getElementById('editor-load');
        const newBtn = document.getElementById('editor-new');
        const undoBtn = document.getElementById('editor-undo');
        const redoBtn = document.getElementById('editor-redo');
        let history = [''];
        let historyPointer = 0;
        const updateHistory = () => {
          const currentCode = codeEditor.value;
          if (currentCode !== history[historyPointer]) {
            if (historyPointer < history.length - 1) {
              history = history.slice(0, historyPointer + 1);
            }
            history.push(currentCode);
            historyPointer = history.length - 1;
          }
        };
        const runCode = () => {
          const fullCode = codeEditor.value;
          const htmlMatch = fullCode.match(/<body>([\s\S]*?)<\/body>/i);
          const cssMatch = fullCode.match(/<style>([\s\S]*?)<\/style>/i);
          const jsMatch = fullCode.match(/<script>([\s\S]*?)<\/script>/i);
          const htmlContent = htmlMatch ? htmlMatch[1] : fullCode;
          const cssContent = cssMatch ? cssMatch[1] : '';
          const jsContent = jsMatch ? jsMatch[1] : '';
          const source = `<!DOCTYPE html><html><head><style>${cssContent}</style></head><body>${htmlContent}<script>${jsContent}<\/script></body></html>`;
          previewFrame.srcdoc = source;
        };
        const saveCode = () => {
          localStorage.setItem('unified_editor_code', codeEditor.value);
          console.log('Code saved successfully');
        };
        const loadCode = () => {
          codeEditor.value =
            localStorage.getItem('unified_editor_code') ||
            `<!DOCTYPE html><html><head><title>My trial</title><style>body {font-family: sans-serif;background-color: #000000;color: #259;text-align: center;padding-top: 50px;}h1 {color: var(--primary);}</style></head><body><h1>Hello Editor</h1><p id="message">Code Here</p><script>document.getElementById('message').onclick = function() {console.log('Paragraph clicked!');};<\/script></body></html>`;
          runCode();
          history = [codeEditor.value];
          historyPointer = 0;
        };
        const newDoc = () => {
          codeEditor.value = `<!DOCTYPE html><html><head><title>New trial</title><style>body {font-family: Arial, sans-serif;background-color: #000000;color: #abb2bf;display: flex;justify-content: center;align-items: center;min-height: 100vh;margin: 0;}h1 {color: #61dafb;}</style></head><body><h1>Start Coding Here!l</h1><script>console.log("New document loaded.");<\/script></body></html>`;
          runCode();
          history = [codeEditor.value];
          historyPointer = 0;
        };
        const undo = () => {
          if (historyPointer > 0) {
            historyPointer--;
            codeEditor.value = history[historyPointer];
            runCode();
          }
        };
        const redo = () => {
          if (historyPointer < history.length - 1) {
            historyPointer++;
            codeEditor.value = history[historyPointer];
            runCode();
          }
        };
        runBtn.addEventListener('click', runCode);
        saveBtn.addEventListener('click', saveCode);
        loadBtn.addEventListener('click', loadCode);
        newBtn.addEventListener('click', newDoc);
        undoBtn.addEventListener('click', undo);
        redoBtn.addEventListener('click', redo);
        codeEditor.addEventListener('input', updateHistory);
        loadCode();
      }
      async function fetchContributions() {
        const display = document.getElementById('contribution-display');
        display.innerHTML = `<p>Loading</p>`;
        try {
          const response = await fetch(CONTRIBUTIONS_WORKER_URL);
          const contributions = await response.json();
          if (contributions && contributions.length > 0) {
            display.innerHTML = contributions
              .reverse()
              .map((c) => {
                return `<div style="background:rgba(0,0,0,0.2);padding:10px;border-radius:5px;margin-bottom:10px;"><p style="margin:0;">${c.text}</p><small style="color:var(--text-secondary);">${new Date(
                  c.timestamp,
                ).toLocaleString()}</small></div>`;
              })
              .join('');
          } else {
            display.innerHTML = `<p>Be the first to leave a message</p>`;
          }
        } catch (e) {
          display.innerHTML = `<p style="color:var(--danger);">Could not load contributions.</p>`;
        }
      }
      document
        .getElementById('contribution-form')
        .addEventListener('submit', async (e) => {
          e.preventDefault();
          const statusEl = document.getElementById('contribution-status');
          statusEl.textContent = 'Uploading';
          const formData = new FormData();
          formData.append('text', document.getElementById('contribution-text').value);
          try {
            const response = await fetch(CONTRIBUTIONS_WORKER_URL, {
              method: 'POST',
              body: formData,
            });
            if (!response.ok) throw new Error('Upload failed');
            statusEl.textContent = 'Message sent. Thank you.';
            e.target.reset();
            fetchContributions();
          } catch (err) {
            statusEl.textContent = `Error: ${err.message}`;
          }
        });
      function initWebsiteAgeDisplay() {
        const websiteAgeDisplay = document.getElementById('website-age-display');
        const creationDate = new Date(2006, 7, 07, 0, 0, 0);
        function updateWebsiteAge() {
          const now = new Date();
          const diff = now.getTime() - creationDate.getTime();
          const seconds = Math.floor(diff / 1000);
          const minutes = Math.floor(seconds / 60);
          const hours = Math.floor(minutes / 60);
          const days = Math.floor(hours / 24);
          const years = Math.floor(days / 365.25);
          const remainingDaysAfterYears = Math.floor(days % 365.25);
          const months = Math.floor(remainingDaysAfterYears / 30.44);
          const remainingDaysAfterMonths = Math.floor(remainingDaysAfterYears % 30.44);
          const displaySeconds = seconds % 60;
          const displayMinutes = minutes % 60;
          const displayHours = hours % 24;
          let ageString = '';
          if (years > 0) ageString += `${years}T `;
          if (months > 0 || years > 0) ageString += `${months}B `;
          ageString += `${remainingDaysAfterMonths}H `;
          ageString += `${displayHours.toString().padStart(2, '0')}:`;
          ageString += `${displayMinutes.toString().padStart(2, '0')}:`;
          ageString += `${displaySeconds.toString().padStart(2, '0')}`;
          websiteAgeDisplay.textContent = `${ageString}`;
        }
        updateWebsiteAge();
        setInterval(updateWebsiteAge, 1000);
      }
      function checkEzraLoginAndShowVisitorsButton() {
        const fabLiveVisitors = document.getElementById('fab-live-visitors');
      }
      document.addEventListener('DOMContentLoaded', checkEzraLoginAndShowVisitorsButton);
      async function fetchLiveVisitors() {
        const visitorList = document.getElementById('visitor-list');
        const lastUpdatedTime = document.getElementById('last-updated-time');
        if (!visitorList.innerHTML.trim() || visitorList.innerHTML.includes('Loading visitors')) {
          visitorList.innerHTML =
            '<li style="text-align: center; color: var(--text-secondary);">Loading</li>';
        }
        try {
          const response = await fetch(LIVE_VISITORS_WORKER_URL + '?get_visitors=true');
          if (!response.ok) {
            throw new Error(`HTTP error! status: ${response.status}`);
          }
          const visitors = await response.json();
          if (visitors && visitors.length > 0) {
            visitorList.innerHTML = visitors
              .map((visitor) => {
                const timestamp = new Date(visitor.timestamp).toLocaleString('id-ID', {
                  hour: '2-digit',
                  minute: '2-digit',
                  second: '2-digit',
                  day: '2-digit',
                  month: '2-digit',
                  year: 'numeric',
                });
                return `<li><strong>ID:</strong> <span>${visitor.browserId.substring(
                  0,
                  10,
                )}</span><br><strong>IP:</strong> <span>${visitor.ip || 'N/A'}</span
                  ><br><strong>Waktu:</strong> <span>${timestamp}</span></li>`;
              })
              .join('');
          } else {
            visitorList.innerHTML =
              '<li style="text-align: center; color: var(--text-secondary);">No online</li>';
          }
          lastUpdatedTime.textContent = new Date().toLocaleTimeString('id-ID');
        } catch (error) {
          console.error('Error fetching live visitors:', error);
          visitorList.innerHTML =
            '<li style="text-align: center; color: var(--danger);">Failed</li>';
          lastUpdatedTime.textContent = 'Error';
        }
      }    
      async function fetchVisitorHistory() {
        const historyContainer = document.getElementById('visitor-history');
        historyContainer.innerHTML = '<p style="text-align: center; color: var(--text-secondary);">Loading history...</p>';
        try {
          const response = await fetch(VISITOR_HISTORY_WORKER_URL + '?get_history=true');
          if (!response.ok) {
            throw new Error(`HTTP error! status: ${response.status}`);
          }
          let history = await response.json();      
          if (history && history.length > 0) {
            historyContainer.innerHTML = `<ul>${history
              .map((visitor) => {
                const timestamp = new Date(visitor.timestamp).toLocaleString('id-ID', {
                  hour: '2-digit',
                  minute: '2-digit',
                  second: '2-digit',
                  day: '2-digit',
                  month: '2-digit',
                  year: 'numeric',
                });
                return `<li><span>ID: ${visitor.browserId.substring(0, 10)}</span><span>IP: ${visitor.ip || 'N/A'}</span><span>${timestamp}</span></li>`;
              })
              .join('')}</ul>`;
          } else {
            historyContainer.innerHTML = '<p style="text-align: center; color: var(--text-secondary);">No visitor history yet</p>';
          }
        } catch (error) {
          console.error('Failed to load visitor history:', error);
          historyContainer.innerHTML = `<p style="text-align: center; color: var(--danger);">Sistem lagi crash</p>`;
        }
      }
      function getBrowserId() {
        let browserId = localStorage.getItem('unique_browser_id');
        if (!browserId) {
          browserId = 'browser_' + Math.random().toString(36).substr(2, 9) + Date.now();
          localStorage.setItem('unique_browser_id', browserId);
        }
        return browserId;
      }
      async function trackVisitor() {
        try {
          const browserId = getBrowserId();
          let ipAddress = 'unknown';
          let referrer = document.referrer || 'direct';
          try {
            const ipResponse = await fetch('https://api.ipify.org?format=json');
            const ipData = await ipResponse.json();
            ipAddress = ipData.ip;
          } catch (ipError) {
            console.warn('Could not fetch IP address:', ipError);
          }
          const data = {
            browserId: browserId,
            ip: ipAddress,
            userAgent: navigator.userAgent,
            timestamp: new Date().toISOString(),
            referrer: referrer
          };        
          fetch(LIVE_VISITORS_WORKER_URL, {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify(data),
          }).catch((e) => console.error('Error sending to live visitors worker:', e));       
          fetch(VISITOR_HISTORY_WORKER_URL, {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify(data),
          }).catch((e) => console.error('Error sending to visitor history worker:', e));  
        } catch (e) {
          console.error('Error in trackVisitor:', e);
        }
      }
      async function fetchMomentVaultGallery() {
        const galleryContainer = document.getElementById('moment-vault-gallery');
        galleryContainer.innerHTML =
          '<p style="text-align: center; color: var(--text-secondary);">Loading</p>';
        try {
          const response = await fetch(MOMENT_VAULT_WORKER_URL + '?get_gallery=true');
          if (!response.ok) {
            throw new Error(`HTTP error! status: ${response.status}`);
          }
          const items = await response.json();
          if (items && items.length > 0) {
            items.sort((a, b) => new Date(b.timestamp) - new Date(a.timestamp));
            galleryContainer.innerHTML = items
              .map((item) => {
                let mediaHTML = '';
                let fileExtension = item.fileUrl.split('.').pop().toLowerCase();
                let iconClass = '';
                if (item.fileType && item.fileType.startsWith('image/')) {
                  mediaHTML = `<img src="${item.fileUrl}" alt="${item.title}">`;
                } else if (item.fileType && item.fileType.startsWith('video/')) {
                  mediaHTML = `<video src="${item.fileUrl}" controls></video>`;
                } else if (item.fileType && item.fileType.startsWith('audio/')) {
                  mediaHTML = `<audio src="${item.fileUrl}" controls></audio>`;
                } else {
                  if (fileExtension === 'pdf') iconClass = 'fa-file-pdf';
                  else if (fileExtension.startsWith('doc')) iconClass = 'fa-file-word';
                  else if (fileExtension === 'txt') iconClass = 'fa-file-alt';
                  else iconClass = 'fa-file';
                  mediaHTML = `<i class="fas ${iconClass} file-icon"></i>`;
                }
                const timestamp = new Date(item.timestamp).toLocaleString('id-ID', {
                  day: '2-digit',
                  month: '2-digit',
                  year: 'numeric',
                  hour: '2-digit',
                  minute: '2-digit',
                });
                return `<div class="gallery-item" data-id="${item.id}"><div class="gallery-media">${mediaHTML}</div><strong>${item.title}</strong><p class="item-text">${item.description}</p><small class="item-date">${timestamp}</small><div class="item-actions"><button class="edit-moment-btn"><i class="fas fa-edit"></i></button><button class="delete-moment-btn"><i class="fas fa-trash-alt"></i></button></div></div>`;
              })
              .join('');
            galleryContainer.querySelectorAll('.edit-moment-btn').forEach((button) => {
              button.addEventListener('click', (e) => {
                const itemId = e.target.closest('.gallery-item').dataset.id;
                editMoment(itemId, items);
              });
            });
            galleryContainer.querySelectorAll('.delete-moment-btn').forEach((button) => {
              button.addEventListener('click', (e) => {
                const itemId = e.target.closest('.gallery-item').dataset.id;
                deleteMoment(itemId);
              });
            });
          } else {
            galleryContainer.innerHTML =
              '<p style="text-align: center; color: var(--text-secondary);">No uploaded yet</p>';
          }
        } catch (error) {
          console.error('Error fetching Moment Vault gallery:', error);
          galleryContainer.innerHTML =
            '<p style="text-align: center; color: var(--danger);">Failed to load gallery items.</p>';
        }
      }
      document.getElementById('moment-upload-form').addEventListener('submit', uploadMoment);
      async function uploadMoment(e) {
        e.preventDefault();
        const statusEl = document.getElementById('moment-upload-status');
        statusEl.textContent = 'Uploading';
        statusEl.style.color = 'var(--text-secondary)';
        const title = document.getElementById('moment-title').value;
        const description = document.getElementById('moment-description').value;
        const fileInput = document.getElementById('moment-file');
        const file = fileInput.files[0];
        if (!file || !title) {
          statusEl.textContent = 'Title and file are required!';
          statusEl.style.color = 'var(--danger)';
          return;
        }
        let githubToken;
        try {
          const tokenResponse = await fetch(GITHUB_TOKEN_WORKER_URL);
          if (!tokenResponse.ok) throw new Error('Failed to fetch GitHub token');
          const tokenData = await tokenResponse.json();
          githubToken = tokenData.token;
          if (!githubToken) throw new Error('GitHub token not found in response');
        } catch (error) {
          console.error('Error getting GitHub token:', error);
          statusEl.textContent = `Error: Could not get GitHub token. ${error.message}`;
          statusEl.style.color = 'var(--danger)';
          return;
        }
        try {
          const filePath = `moments/${Date.now()}-${file.name}`;
          const fileContent = await readFileAsBase64(file);
          const githubApiUrl = `https://api.github.com/repos/${GITHUB_REPO_OWNER}/${GITHUB_REPO_NAME}/contents/${filePath}`;
          const uploadResponse = await fetch(githubApiUrl, {
            method: 'PUT',
            headers: {
              Authorization: `token ${githubToken}`,
              'Content-Type': 'application/json',
            },
            body: JSON.stringify({
              message: `Upload moment: ${title}`,
              content: fileContent,
              branch: 'main',
            }),
          });
          if (!uploadResponse.ok) {
            const errorText = await uploadResponse.text();
            throw new Error(`GitHub upload failed: ${uploadResponse.status} - ${errorText}`);
          }
          const uploadData = await uploadResponse.json();
          const rawFileUrl = uploadData.content.download_url;
          const momentData = {
            id: 'moment_' + Math.random().toString(36).substr(2, 9) + Date.now(),
            title: title,
            description: description,
            fileUrl: rawFileUrl,
            fileType: file.type,
            timestamp: new Date().toISOString(),
          };
          const kvSaveResponse = await fetch(MOMENT_VAULT_WORKER_URL, {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify(momentData),
          });
          if (!kvSaveResponse.ok) {
            throw new Error('Failed to save moment metadata to KV');
          }
          statusEl.textContent = 'successfully';
          statusEl.style.color = 'var(--success)';
          e.target.reset();
          fetchMomentVaultGallery();
        } catch (error) {
          console.error('Error uploading moment:', error);
          statusEl.textContent = `Error uploading moment: ${error.message}`;
          statusEl.style.color = 'var(--danger)';
        }
      }
      async function editMoment(itemId, currentItems) {
        const password = prompt('Masukkan password untuk mengedit:');
        if (password !== MOMENT_VAULT_PASSWORD) {
            alert('Password salah!');
            return;
        }
        const itemToEdit = currentItems.find((item) => item.id === itemId);
        if (!itemToEdit) return;
        const newTitle = prompt('Edit Title:', itemToEdit.title);
        if (newTitle === null) return;
        const newDescription = prompt('Edit Description:', itemToEdit.description);
        if (newDescription === null) return;
        const statusEl = document.getElementById('moment-upload-status');
        statusEl.textContent = 'Updating';
        statusEl.style.color = 'var(--text-secondary)';
        try {
          const updatedMomentData = {
            id: itemId,
            title: newTitle,
            description: newDescription,
            fileUrl: itemToEdit.fileUrl,
            fileType: itemToEdit.fileType,
            timestamp: itemToEdit.timestamp,
          };
          const response = await fetch(MOMENT_VAULT_WORKER_URL, {
            method: 'PUT',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify(updatedMomentData),
          });
          if (!response.ok) {
            throw new Error('Failed to update moment metadata');
          }
          statusEl.textContent = 'successfully';
          statusEl.style.color = 'var(--success)';
          fetchMomentVaultGallery();
        } catch (error) {
          console.error('Error updating moment:', error);
          statusEl.textContent = `Error updating moment: ${error.message}`;
          statusEl.style.color = 'var(--danger)';
        }
      }
      async function deleteMoment(itemId) {
        const password = prompt('Masukkan password untuk menghapus:');
        if (password !== MOMENT_VAULT_PASSWORD) {
            alert('Password salah!');
            return;
        }
        if (!confirm('Are you sure you want to delete? This action cannot be undone.')) {
          return;
        }
        const statusEl = document.getElementById('moment-upload-status');
        statusEl.textContent = 'Deleting';
        statusEl.style.color = 'var(--text-secondary)';
        try {
          let githubToken;
          try {
            const tokenResponse = await fetch(GITHUB_TOKEN_WORKER_URL);
            if (!tokenResponse.ok) throw new Error('Failed to fetch GitHub token');
            const tokenData = await tokenResponse.json();
            githubToken = tokenData.token;
            if (!githubToken) throw new Error('GitHub token not found in response');
          } catch (error) {
            console.error('Error getting GitHub token for delete:', error);
            statusEl.textContent = `Error: Could not get GitHub token for deletion. ${error.message}`;
            statusEl.style.color = 'var(--danger)';
            return;
          }
          const galleryResponse = await fetch(MOMENT_VAULT_WORKER_URL + '?get_gallery=true');
          if (!galleryResponse.ok) throw new Error('Failed to fetch gallery to find file path');
          const galleryItems = await galleryResponse.json();
          const itemToDelete = galleryItems.find((item) => item.id === itemId);
          if (!itemToDelete || !itemToDelete.fileUrl) {
            throw new Error('its file URL not found.');
          }
          let filePathOnGithub;
          const rawGithubContentBase = `https://raw.githubusercontent.com/${GITHUB_REPO_OWNER}/${GITHUB_REPO_NAME}/main/`;
          if (itemToDelete.fileUrl.startsWith(rawGithubContentBase)) {
            filePathOnGithub = itemToDelete.fileUrl.substring(rawGithubContentBase.length);
          } else {
            console.warn(
              'Unexpected file URL format, attempting fallback path extraction:',
              itemToDelete.fileUrl,
            );
            filePathOnGithub = `moments/${itemToDelete.fileUrl.split('/').pop()}`;
          }
          const githubApiGetFileUrl = `https://api.github.com/repos/${GITHUB_REPO_OWNER}/${GITHUB_REPO_NAME}/contents/${filePathOnGithub}`;
          const getFileResponse = await fetch(githubApiGetFileUrl, {
            headers: {
              Authorization: `token ${githubToken}`,
              Accept: 'application/vnd.github.v3+json',
            },
          });
          if (!getFileResponse.ok) {
            const errorText = await getFileResponse.text();
            throw new Error(`Failed to get file SHA from GitHub: ${getFileResponse.status} - ${errorText}`);
          }
          const fileMetaData = await getFileResponse.json();
          const fileSha = fileMetaData.sha;
          const githubDeleteUrl = `https://api.github.com/repos/${GITHUB_REPO_OWNER}/${GITHUB_REPO_NAME}/contents/${filePathOnGithub}`;
          const deleteResponse = await fetch(githubDeleteUrl, {
            method: 'DELETE',
            headers: {
              Authorization: `token ${githubToken}`,
              'Content-Type': 'application/json',
            },
            body: JSON.stringify({
              message: `Delete moment: ${itemToDelete.title}`,
              sha: fileSha,
              branch: 'main',
            }),
          });
          if (!deleteResponse.ok) {
            const errorText = await deleteResponse.text();
            throw new Error(`GitHub deletion failed: ${deleteResponse.status} - ${errorText}`);
          }
          const kvDeleteResponse = await fetch(
            MOMENT_VAULT_WORKER_URL + `?delete_moment_id=${itemId}`,
            {
              method: 'DELETE',
            },
          );
          if (!kvDeleteResponse.ok) {
            throw new Error('Failed to delete');
          }
          statusEl.textContent = 'successfully';
          statusEl.style.color = 'var(--success)';
          fetchMomentVaultGallery();
        } catch (error) {
          console.error('Error deleting moment:', error);
          statusEl.textContent = `Error deleting moment: ${error.message}`;
          statusEl.style.color = 'var(--danger)';
        }
      }
      function initVisualizer() {
        visualizerCanvas = document.getElementById('visualizer-canvas');
        ctx = visualizerCanvas.getContext('2d');
        resizeVisualizer();
        window.addEventListener('resize', resizeVisualizer);
      }
      function resizeVisualizer() {
        visualizerCanvas.width = window.innerWidth;
        visualizerCanvas.height = window.innerHeight;
        if (isVisualizerActive) {
          ctx.clearRect(0, 0, visualizerCanvas.width, visualizerCanvas.height);
        }
      }
      function setupAudioVisualizer() {
        const audioPlayer = document.getElementById('audio-player');
        if (!audioPlayer.src) {
          alert('Pilih lagu terlebih dahulu');
          return;
        }
        if (!audioContext) {
          audioContext = new (window.AudioContext || window.webkitAudioContext)();
          analyser = audioContext.createAnalyser();
          source = audioContext.createMediaElementSource(audioPlayer);
          source.connect(analyser);
          analyser.connect(audioContext.destination);
          analyser.fftSize = 8192;
          bufferLength = analyser.frequencyBinCount;
          frequencyData = new Uint8Array(bufferLength);
        }
        audioPlayer.play();
        createParticles();
      }
      function createParticles() {
        particles = [];
        for (let i = 0; i < PARTICLE_COUNT; i++) {
          particles.push({
            x: visualizerCanvas.width / 2,
            y: visualizerCanvas.height / 2,
            size: Math.random() * 2 + 1,
            speedX: (Math.random() - 0.5) * PARTICLE_SPEED_MULTIPLIER,
            speedY: (Math.random() - 0.5) * PARTICLE_SPEED_MULTIPLIER,
            color: `hsl(${Math.random() * 360}, 100%, 50%)`,
          });
        }
      }
      function drawVisualizer() {
        if (!isVisualizerActive) return;
        requestAnimationFrame(drawVisualizer);
        analyser.getByteFrequencyData(frequencyData);
        ctx.clearRect(0, 0, visualizerCanvas.width, visualizerCanvas.height);
        const center_x = visualizerCanvas.width / 2;
        const center_y = visualizerCanvas.height / 2;
        const radius = Math.min(center_x, center_y) * 0.4;
        const sampleRate = audioContext.sampleRate;
        const maxFreq = 1000;
        const maxIndex = Math.floor((maxFreq / (sampleRate / 2)) * bufferLength);
        const effectiveBufferLength = maxIndex;
        const slice = (2 * Math.PI) / effectiveBufferLength;
        for (let i = 0; i < effectiveBufferLength; i++) {
            const barHeight = frequencyData[i] * 0.7;
            const angle = slice * i;
            const x = center_x + Math.cos(angle) * (radius + barHeight);
            const y = center_y + Math.sin(angle) * (radius + barHeight);
            ctx.beginPath();
            ctx.moveTo(center_x, center_y);
            ctx.lineTo(x, y);
            const hue = (i / effectiveBufferLength) * 360;
            ctx.strokeStyle = `hsl(${hue}, 100%, 50%)`;
            ctx.lineWidth = 1;
            ctx.stroke();
        }
        const averageAmplitude = frequencyData.slice(0, effectiveBufferLength).reduce((a, b) => a + b) / effectiveBufferLength;
        const particleSpeedFactor = averageAmplitude / 255 * 3;
        for (let i = 0; i < particles.length; i++) {
          const p = particles[i];        
          p.speedX += gravity.x * 0.05;
          p.speedY += gravity.y * 0.05;
          p.x += p.speedX * particleSpeedFactor;
          p.y += p.speedY * particleSpeedFactor;
          if (p.x < 0 || p.x > visualizerCanvas.width) p.speedX *= -1;
          if (p.y < 0 || p.y > visualizerCanvas.height) p.speedY *= -1;
          const colorHue = (averageAmplitude * 1.5 + (i * 360 / PARTICLE_COUNT));
          p.color = `hsl(${colorHue % 360}, 100%, 50%)`;
          const particleSize = p.size + (averageAmplitude / 100);
          ctx.beginPath();
          ctx.arc(p.x, p.y, particleSize, 0, Math.PI * 2);
          ctx.fillStyle = p.color;
          ctx.fill();
        }
      }
      function toggleVisualizerOverlay() {
        const audioPlayer = document.getElementById('audio-player');
        const body = document.body;
        if (!isVisualizerActive) {
          if (!audioPlayer.src || audioPlayer.paused) {
            alert('Putar musik terlebih dahulu');
            return;
          }
          setupAudioVisualizer();
          if (!analyser) return;
          isVisualizerActive = true;
          body.classList.add('visualizer-active');
          createParticles();
          drawVisualizer();
          toggleFullscreen();
        } else {
          isVisualizerActive = false;
          body.classList.remove('visualizer-active');
          toggleFullscreen();
        }
      }
      function toggleFullscreen() {
    if (!document.fullscreenElement) {
        document.documentElement.requestFullscreen().catch(err => {
            console.log(`Error when system attempting to enable fullscreen: ${err.message}`);
        });
    } else {
        if (document.exitFullscreen) {
            document.exitFullscreen();       }    }}
        function initVirtualKeyboard() {
            const keyboardPanel = document.getElementById('keyboard-panel');
            const keyboardInput = document.getElementById('keyboard-input');
            const liveVisitorsButton = document.getElementById('fab-live-visitors');
            const centerVideoContainer = document.getElementById('center-video-container');
            const centerVideoPlayer = document.getElementById('center-video-player');
            const centerVideoCloseBtn = document.getElementById('center-video-close');
            
            const passwordMap = {
                'mylove 47': () => {
                    liveVisitorsButton.style.display = 'flex';
                    keyboardPanel.classList.remove('active');
                },
                'elviu': () => {
                    centerVideoContainer.classList.add('active');
                    centerVideoPlayer.src = 'bg.mp4';
                    centerVideoPlayer.play();
                    keyboardPanel.classList.remove('active');
                    keyboardInput.value = '';
                },
                'password3': () => { console.log('Fungsi password 3'); },
                'password4': () => { console.log('Fungsi password 4'); },
                'password5': () => { console.log('Fungsi password 5'); },
                'password6': () => { console.log('Fungsi password 6'); },
                'password7': () => { console.log('Fungsi password 7'); },
                'password8': () => { console.log('Fungsi password 8'); },
                'password9': () => { console.log('Fungsi password 9'); },
                'password10': () => { console.log('Fungsi password 10'); },
            };
            
            let currentInput = '';
            
            document.querySelectorAll('.keyboard-key').forEach(button => {
                button.addEventListener('click', (e) => {
                    const keyText = e.target.closest('.keyboard-key').textContent.trim();
                    if (e.target.closest('.keyboard-key').id === 'backspace-key') {
                        currentInput = currentInput.slice(0, -1);
                    } else if (e.target.closest('.keyboard-key').id === 'space-key') {
                        currentInput += ' ';
                    } else {
                        currentInput += keyText;
                    }
            
                    keyboardInput.value = currentInput;
            
                    if (passwordMap[currentInput]) {
                        passwordMap[currentInput]();
                        currentInput = '';
                        keyboardInput.value = '';
                    } else {
                        // Reset all buttons to hidden if the password is wrong
                        liveVisitorsButton.style.display = 'none';
                        // ... Tambahkan kode untuk menyembunyikan fitur lain di sini
                    }
                });
            });
            centerVideoCloseBtn.addEventListener('click', () => {
                centerVideoPlayer.pause();
                centerVideoPlayer.src = '';
                centerVideoContainer.classList.remove('active');
            });
        }
      function initSecurityFeatures() {
        const popup = document.getElementById('screenshot-popup');
        const body = document.body;
        
        // Mencegah Copy-Paste
        document.addEventListener('copy', (e) => {
          e.preventDefault();
          alert('Copy-paste tidak diizinkan di website ini.');
        });
        document.addEventListener('contextmenu', (e) => e.preventDefault());
        document.addEventListener('cut', (e) => e.preventDefault());
        
        // Screenshot detection (sederhana, tidak 100% akurat)
        let isPopupShowing = false;
        function showPopup() {
            if (!isPopupShowing) {
                popup.style.display = 'block';
                isPopupShowing = true;
                setTimeout(() => {
                    popup.style.display = 'none';
                    isPopupShowing = false;
                }, 3000);
            }
        }
        
        document.addEventListener('keydown', (e) => {
          // Deteksi kombinasi umum untuk screenshot
          if (
              (e.key === 'PrintScreen') ||
              (e.ctrlKey && e.key === 'a') ||
              (e.metaKey && e.shiftKey && e.key === '4') || // MacOS
              (e.metaKey && e.shiftKey && e.key === '3') // MacOS
          ) {
            showPopup();
          }
        });
        
        // Deteksi dari kombinasi tombol lainnya
        window.addEventListener('keyup', (e) => {
            if (e.key === 'PrintScreen') {
                showPopup();
            }
        });
        
        // Untuk mobile, mendeteksi volume down + power
        // Ini lebih sulit dan memerlukan event khusus yang mungkin tidak didukung semua browser
        // Tapi kita bisa coba deteksi event yang mirip
        // Sebagai contoh, deteksi dari perubahan fokus yang bisa mengindikasikan screenshot
        document.addEventListener('visibilitychange', () => {
            if (document.visibilityState === 'hidden' && !document.hidden) {
                showPopup();
            }
        });
        
        // Tambahkan watermark
        const watermark = document.getElementById('watermark');
        if (watermark) {
            // Watermark sudah ada di HTML, cukup pastikan ditampilkan
            watermark.style.display = 'block';
        }
      }
    </script>
  </body>
</html>
